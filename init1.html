<!DOCTYPE html>
<html>
   <head>
      <meta charset = "UTF-8">
      <meta http-equiv = "X-UA-Compatible" content = "IE = edge,chrome = 1">
      <title>Hello World using Backbone.js</title>
   </head>
   
   <body id="body">
      <script src = "https://code.jquery.com/jquery-2.1.3.min.js" type = "text/javascript"></script>      
      <script src = "https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore.js" type = "text/javascript"></script>
      <script src = "https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone.js" type = "text/javascript"></script>

    <script type="text/javascript" src="js/kendo/js/jquery.min.js"></script>
    <script src = "js/kendo/js/jszip.min.js" type="text/javascript" </script> 
    <script src = "js/kendo/js/kendo.all.min.2015.2.624.js" type="text/javascript" </script>   
    <script src = "js/kendo/js/pako_deflate.min.js" type="text/javascript" </script>   
    <script src = "js/kendo/js/cultures/kendo.culture.es-CO.min.js" type="text/javascript" </script>  

    <link rel="stylesheet" href="js/kendo/styles/kendo.mobile.all.min.css">
          
      <script type = "text/javascript">

      //'Router' is a name of the router class
      var Router = Backbone.Router.extend ({
         routes: {
              'list': 'list',
              'new': 'new',
              'update': 'update'
         },

          list: function(){
               listUsers();
          },
          new: function () {
               newUser();
          },
          update: function() {
               updateUser();
          }
      });

      //'router' is an instance of the Router
      var router = new Router();

      //Start listening to the routes and manages the history for bookmarkable URL's
      Backbone.history.start();

         var User = Backbone.Model.extend({
            defaults:{
               id: null,
               email: null,
               firstname: null,
               secondname: null,
               lastname: null,
               secondlastname: null,
               password: null,
               roles: null
            },
            url: 'http://localhost/rentbike/web/app_dev.php/user',
            initialize: function(){
               // TODO: acciones de inicialización del modelo
            }
         });

         var UserCollection = Backbone.Collection.extend({
            model: User,
            url: function() {
               return 'http://localhost/rentbike/web/app_dev.php/user';
            },
            initialize: function(){
               // TODO: acciones de inicialización del modelo
            }
         });


         NewUserView = Backbone.View.extend({
             //template: _.template($('#ficha_template').html()),
             render: function(){
                 
               var div = $('<div></div>');

               var form = $('<form></form>');

               

               var fields = [];


               var firstname = '<input type="text" id="firstname-user"></input>';
               var secondname = '<input type="text" id="secondname-user"></input>';
               var lastname = '<input type="text" id="lastname-user"></input>';
               var secondlastname = '<input type="text" id="secondlastname-user"></input>';
               var password = '<input type="password" id="password-user"></input>';

               fields.push(firstname);
               fields.push(secondname);
               fields.push(lastname);
               fields.push(secondlastname);
               fields.push(password);

               for (var i = 0; i < fields.length; i++) {
                  var field = fields[i];
                  var formgroup = $('<div class="form-group"></div>');
                  formgroup.append(field);

                  form.append(formgroup);   
               }


               div.append(form);

               $(this.el).append(div);

               return this;

             }
         });


         function listUsers () {

            $('#body').append('<div id="grid"></div>');

            $("#grid").kendoGrid({
                        dataSource: {
                            type: "odata",
                            transport: {
                                read: "https://demos.telerik.com/kendo-ui/service/Northwind.svc/Orders"
                            },
                            schema: {
                                model: {
                                    fields: {
                                        OrderID: { type: "number" },
                                        Freight: { type: "number" },
                                        ShipName: { type: "string" },
                                        OrderDate: { type: "date" },
                                        ShipCity: { type: "string" }
                                    }
                                }
                            },
                            pageSize: 20,
                            serverPaging: true,
                            serverFiltering: true,
                            serverSorting: true
                        },
                        height: 550,
                        filterable: true,
                        sortable: true,
                        pageable: true,
                        columns: [{
                                field:"OrderID",
                                filterable: false
                            },
                            "Freight",
                            {
                                field: "OrderDate",
                                title: "Order Date",
                                format: "{0:MM/dd/yyyy}"
                            }, {
                                field: "ShipName",
                                title: "Ship Name"
                            }, {
                                field: "ShipCity",
                                title: "Ship City"
                            }
                        ]
                    });

         }

         function newUser(argument) {
            debugger
            /*var newUser = new NewUserView({el:$('body')});

            newUser.render();*/


         //    /*console.log('Crear Usuario');
         //    var newUser = new User({
         //       "email":"pepito@gmail.com",
         //       "firstname":"Pepito",
         //       "lastname":"Perez",
         //       "password": "12345"
         //       }
         //    );

         //    libroNuevo.save();
         //    coleccion_libros.add(newUser);*/

         }

         function updateUser() {
            debugger
         }


      
      </script>
      <div>
         <a id="list" href = "#list">Listar </a>
         <a id="save" href = "#new">Nuevo </a>
         <a id="update" href = "route3">Route3 </a>
      </div>
      
      <div id="#jsGrid"></div>
    

   </body>
</html>